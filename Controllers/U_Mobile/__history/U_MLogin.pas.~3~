unit U_MLogin;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics,
  Controls, Forms, uniGUITypes, uniGUIAbstractClasses,
  uniGUIClasses, uniGUImClasses, uniGUIRegClasses, uniGUIForm, uniGUImForm, uniGUImJSForm,
  uniButton, unimButton, uniGUIBaseClasses, uniLabel, unimLabel, uniEdit,
  unimEdit, uniMultiItem, unimSelect, uniImage, unimImage, Data.DB,
  Data.Win.ADODB;

type
  TUnimLoginForm2 = class(TUnimLoginForm)
    UnimLabel1: TUnimLabel;
    UnimButton1: TUnimButton;
    UnimImage1: TUnimImage;
    UnimSelect1: TUnimSelect;
    UnimEdit_usuario: TUnimEdit;
    UnimEdit_senha: TUnimEdit;
    procedure UnimButton1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

function UnimLoginForm2: TUnimLoginForm2;

implementation

{$R *.dfm}

uses
  uniGUIVars, MainModule, uniGUIApplication, ServerModule;

function UnimLoginForm2: TUnimLoginForm2;
begin
  Result := TUnimLoginForm2(UniMainModule.GetFormInstance(TUnimLoginForm2));
end;

procedure TUnimLoginForm2.UnimButton1Click(Sender: TObject);
var usuario, senha: String;
begin
  usuario:= UnimEdit_usuario.Text;
  senha:= UnimEdit_senha.Text;

  UniServerModule.ADOQuery_login.Close;
  UniServerModule.ADOQuery_login.SQL.Clear;
  UniServerModule.ADOQuery_login.SQL.Add('SELECT CL_ID FROM CAD_CL WHERE CL_NOME = '+chr(39)+usuario+chr(39));

  try
    UniServerModule.ADOConnection1.Connected:= True;
    UniServerModule.ADOQuery_login.Open;
    except on E: Exception do begin
       ShowMessage(E.Message);
    end;

  End;
  ModalResult:= mrOK;
end;

initialization
  RegisterAppFormClass(TUnimLoginForm2);

end.
